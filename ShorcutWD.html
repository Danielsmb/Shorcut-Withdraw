<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Shortcut Withdraw</title>
    <style>
        /* CSS untuk tampilan */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 800px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #34495e;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box; /* Penting agar padding tidak menambah lebar */
            font-size: 16px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 30px;
        }
        button {
            padding: 12px 25px;
            font-size: 16px;
            font-weight: bold;
            color: #fff;
            background-color: #3498db;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #2980b9;
        }
        #copyButton {
            background-color: #2ecc71;
        }
        #copyButton:hover {
            background-color: #27ae60;
        }
        #copyButton:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .output-section {
            margin-top: 40px;
            display: none; /* Sembunyikan awalnya */
        }
        .output-section h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #ecf0f1;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        td {
            word-wrap: break-word; /* Mencegah teks panjang merusak layout */
        }
        
        /* Style untuk Tabel Cross-Check Baru */
        .crosscheck-table {
            margin-bottom: 30px; /* Beri jarak dengan elemen di bawahnya */
            background-color: #f8f9fa; /* Warna latar sedikit berbeda */
        }
        .crosscheck-table th {
            background-color: #e9ecef; /* Warna header yang lebih gelap */
        }
        .crosscheck-table .total-row {
            font-weight: bold;
            background-color: #e9ecef; /* Sorot baris total */
        }

    </style>
</head>

<body>

    <div class="container">
        <h1>Web Shortcut Withdraw</h1>

        <div class="input-form">
            <div class="input-group">
                <label for="nominal">Nominal Total</label>
                <input type="text" id="nominal" placeholder="Contoh: 300000000">
            </div>
            <div class="input-group">
                <label for="nomorRekening">Nomor Rekening</label>
                <input type="text" id="nomorRekening" placeholder="Masukkan nomor rekening">
            </div>
            <div class="input-group">
                <label for="id">ID</label>
                <input type="text" id="id" placeholder="Masukkan ID">
            </div>
            <div class="input-group">
                <label for="namaRekening">Nama Rekening</label>
                <input type="text" id="namaRekening" placeholder="Masukkan nama rekening">
            </div>
        </div>

        <div class="button-group">
            <button id="processButton">Proses</button>
        </div>

        <div id="outputSection" class="output-section">
            <!-- Tabel Cross-Check akan muncul di sini -->
            <div id="crosscheckContainer">
                <!-- Konten akan di-generate oleh JavaScript -->
            </div>

            <button id="copyButton">Salin Tabel</button>
            <div id="tableContainer">
                <!-- Tabel utama akan di-generate oleh JavaScript di sini -->
            </div>
        </div>
    </div>

    <script>
        // JavaScript untuk logika
        const processButton = document.getElementById('processButton');
        const copyButton = document.getElementById('copyButton');
        const outputSection = document.getElementById('outputSection');
        const tableContainer = document.getElementById('tableContainer');
        const crosscheckContainer = document.getElementById('crosscheckContainer'); // Tambahkan selector untuk kontainer cross-check

        const nominalInput = document.getElementById('nominal');
        const nomorRekeningInput = document.getElementById('nomorRekening');
        const idInput = document.getElementById('id');
        const namaRekeningInput = document.getElementById('namaRekening');

        processButton.addEventListener('click', () => {
            // 1. Ambil nilai dari input
            const nominalString = nominalInput.value.replace(/\D/g, '');
            const totalAmount = parseInt(nominalString, 10);
            
            const nomorRekening = nomorRekeningInput.value;
            const id = idInput.value;
            const namaRekening = namaRekeningInput.value;

            // 2. Validasi input
            if (isNaN(totalAmount) || totalAmount <= 0) {
                alert('Masukkan nominal yang valid (angka positif).');
                return;
            }
            if (!nomorRekening || !id || !namaRekening) {
                alert('Semua kolom (Nomor Rekening, ID, Nama Rekening) harus diisi.');
                return;
            }

            // 3. Proses pemecahan nominal
            const chunkSize = 40000000; // 40 Juta
            const fullChunks = Math.floor(totalAmount / chunkSize);
            const remainder = totalAmount % chunkSize;

            let rows = [];
            let crosscheckData = []; // Array untuk data tabel cross-check

            // Tambahkan baris untuk setiap potongan 40jt
            for (let i = 0; i < fullChunks; i++) {
                const chunkAmount = chunkSize;
                rows.push({
                    nominal: chunkAmount,
                    nomorRekening: nomorRekening,
                    id: id,
                    namaRekening: namaRekening
                });
                
                // Siapkan data untuk tabel cross-check
                crosscheckData.push({
                    part: i + 1,
                    amount: chunkAmount
                });
            }

            // Tambahkan baris untuk sisa nominal jika ada
            if (remainder > 0) {
                rows.push({
                    nominal: remainder,
                    nomorRekening: nomorRekening,
                    id: id,
                    namaRekening: namaRekening
                });

                // Siapkan data untuk tabel cross-check
                crosscheckData.push({
                    part: fullChunks + 1,
                    amount: remainder
                });
            }
            
            // 4. Buat dan tampilkan tabel
            generateCrosscheckTable(totalAmount, crosscheckData); // Panggil fungsi untuk membuat tabel cross-check
            generateTable(rows);
            outputSection.style.display = 'block'; // Tampilkan bagian hasil
        });

        /**
         * Fungsi untuk membuat dan menampilkan tabel cross-check nominal.
         * @param {number} totalAmount - Nominal total awal.
         * @param {Array<Object>} data - Array data pecahan nominal.
         */
        function generateCrosscheckTable(totalAmount, data) {
            // Kosongkan container tabel sebelumnya
            crosscheckContainer.innerHTML = '';

            let tableHTML = `
                <h2>Cross-Check Nominal</h2>
                <table class="crosscheck-table">
                    <thead>
                        <tr>
                            <th>Deskripsi</th>
                            <th>Nominal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Nominal Total</td>
                            <td data-raw-value="${totalAmount}">${totalAmount.toLocaleString('id-ID')}</td>
                        </tr>
            `;

            // Tambahkan baris untuk setiap bagian nominal
            data.forEach(item => {
                tableHTML += `
                    <tr>
                        <td>Bagian ${item.part}</td>
                        <td data-raw-value="${item.amount}">${item.amount.toLocaleString('id-ID')}</td>
                    </tr>
                `;
            });

            tableHTML += `
                        <tr class="total-row">
                            <td>Total Pecahan</td>
                            <td data-raw-value="${totalAmount}">${totalAmount.toLocaleString('id-ID')}</td>
                        </tr>
                    </tbody>
                </table>
            `;
            
            crosscheckContainer.innerHTML = tableHTML;
        }

        function generateTable(data) {
            // Kosongkan container tabel sebelumnya
            tableContainer.innerHTML = '';

            let tableHTML = `
                <h2>Hasil Pemecahan</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Nominal</th>
                            <th>Nomor Rekening</th>
                            <th>ID</th>
                            <th>Nama Rekening</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            data.forEach(row => {
                // Format nominal untuk ditampilkan di web menggunakan 'id-ID' agar sesuai format Indonesia
                const formattedNominal = row.nominal.toLocaleString('id-ID');
                
                tableHTML += `
                    <tr>
                        <td data-raw-value="${row.nominal}">${formattedNominal}</td>
                        <td>${row.nomorRekening}</td>
                        <td>${row.id}</td>
                        <td>${row.namaRekening}</td>
                    </tr>
                `;
            });

            tableHTML += `
                    </tbody>
                </table>
            `;
            
            tableContainer.innerHTML = tableHTML;
        }

        copyButton.addEventListener('click', () => {
            const table = document.querySelector('#tableContainer table');
            if (!table) return;

            const rowsText = [];
            const dataRows = table.querySelectorAll('tbody tr');
            
            dataRows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const rowText = Array.from(cells).map(cell => {
                    // Saat menyalin, gunakan angka asli dari data-raw-value
                    return cell.dataset.rawValue || cell.textContent;
                }).join('\t');
                rowsText.push(rowText);
            });

            const tableText = rowsText.join('\n');
            
            navigator.clipboard.writeText(tableText).then(() => {
                const originalText = copyButton.innerText;
                copyButton.innerText = 'Tersalin!';
                copyButton.disabled = true;

                setTimeout(() => {
                    copyButton.innerText = originalText;
                    copyButton.disabled = false;
                }, 2000);
            }).catch(err => {
                console.error('Gagal menyalin teks: ', err);
                alert('Gagal menyalin teks, silakan salin secara manual.');
            });
        });

    </script>

</body>
</html>
